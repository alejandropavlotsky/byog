{"ast":null,"code":"var _jsxFileName = \"/Users/alejandromurawczik/Movies/Programacion/ IronHack/Ironhack/week7/day5/BYOG/client/src/components/pages/eventDetails/EventDetails.js\";\nimport React, { Component } from 'react';\nimport EventService from '../../../service/events.service';\nimport moment from 'moment';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Modal from 'react-bootstrap/Modal';\nimport Button from 'react-bootstrap/Button';\nimport Spinner from 'react-bootstrap/Spinner';\nimport Toast from 'react-bootstrap/Toast'; // import GoogleMapReact from 'google-map-react'\n\nimport ReviewForm from './../reviewForm/ReviewForm';\nimport './EventDetails.css';\n\nclass EventDetails extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleModal = visible => this.setState({\n      modalShow: visible\n    });\n\n    this.handleToast = (visible, text = '') => {\n      const toastCopy = { ...this.state.toast\n      };\n      toastCopy.show = visible;\n      toastCopy.text = text;\n      this.setState({\n        toast: toastCopy\n      });\n    };\n\n    this.handleEventSign = e => {\n      if (attendance > 0 && !this.state.event.assitance.includes(this.props.loggedInUser.username)) {\n        let eventCopy = this.state.event;\n        eventCopy.assistance.push(this.props.loggedInUser._id);\n        enevtCopy.attendance -= 1;\n      }\n\n      const assistanceCopy = [...this.state.event.assistance, this.props.loggedInUser._id];\n      let attendanceCopy = this.state.event.attendance;\n      this.eventService.editEvent(eventCopy).then(response => this.setState({\n        event: response.data\n      })).catch(err => console.log(err));\n    };\n\n    this.componentDidMount = () => {\n      this.getEventInfo();\n    };\n\n    this.finishEventPost = () => {\n      this.getAllEvents();\n      this.handleModal(false);\n      this.handleToast(true, 'El comentario se ha creado con éxito!');\n    };\n\n    this.state = {\n      event: null,\n      // center: {\n      // \tlat: props.lat,\n      // \tlng: props.lng\n      // },\n      attendance: 0,\n      loggedInUser: this.props.loggedInUser,\n      modalShow: false,\n      toast: {\n        show: false,\n        text: ''\n      }\n    };\n    this.eventService = new EventService();\n  } // static defaultProps = {\n  // \tcenter: {\n  // \t\tlat: 40.420524,\n  // \t\tlng: -3.705128\n  // \t},\n  // \tzoom: 16\n  // }\n\n\n  // this.setState({ event: { ...this.state.event, assistance: assistanceCopy, attendance: attendanceCopy } }, () => console.log(\"vengo del callback \", this.state.event))\n  // this.setState(\n  // \t{ event: { ...this.state.event, assistance: assistanceCopy, attendance: attendanceCopy } }, () => {\n  // \t\tthis.eventService\n  // \t\t\t.editEvent(this.state.event)\n  // \t\t\t.then(response => console.log(response.data))\n  // \t\t\t// .then(response => this.setState({ event: response.data }))\n  // \t\t\t.catch(err => console.log(err))\n  // \t}\n  // )\n  getEventInfo() {\n    const id = this.props.match.params.eventId;\n    this.eventService.getEvent(id).then(response => this.setState({\n      event: response.data\n    })).catch(err => console.log(err));\n  } // () => this.getGoogleMap()\n  // getGoogleMap() {\n  // \tlet location = this.state.event.location\n  // \tlet key = 'AIzaSyA5zll-K3WnkRdKTRaRgbyeC_JkL76ygyM'\n  // \taxios.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${location}&key=${key}`).then(geores => {\n  // \t\tlet latitude = geores.data.results[0].geometry.location.lat\n  // \t\tlet longitude = geores.data.results[0].geometry.location.lng\n  // \t\tthis.setState({\n  // \t\t\tcenter: {\n  // \t\t\t\tlat: latitude,\n  // \t\t\t\tlng: longitude\n  // \t\t\t}\n  // \t\t})\n  // \t})\n  // }\n\n\n  render() {\n    if (this.state.event) {\n      const {\n        author,\n        title,\n        description,\n        location,\n        attendance,\n        gameDate,\n        reviews,\n        assistance\n      } = this.state.event;\n      const isAttending = this.props.loggedInUser && assistance && assistance.length > 0 && assistance.findIndex(user => user._id === this.props.loggedInUser._id) > -1;\n      return /*#__PURE__*/React.createElement(Container, {\n        as: \"section\",\n        className: \"event-details\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 6\n        }\n      }, title), /*#__PURE__*/React.createElement(Row, {\n        as: \"article\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 6\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        md: {\n          span: 5,\n          offset: 1\n        },\n        className: \"map-button-event-details\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        id: \"map\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 8\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"event-details-buttons\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 8\n        }\n      }, /*#__PURE__*/React.createElement(Link, {\n        to: \"/events\",\n        className: \"btn btn-success btn-one\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 9\n        }\n      }, \"Volver\"), this.state.loggedInUser && /*#__PURE__*/React.createElement(Button, {\n        onClick: this.handleEventSign,\n        disabled: isAttending,\n        className: \"btn btn-success btn-one\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 10\n        }\n      }, \"Apuntarme\"))), /*#__PURE__*/React.createElement(Col, {\n        md: {\n          span: 5\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 8\n        }\n      }, \"Detalles\"), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 8\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 8\n        }\n      }, ' ', /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 9\n        }\n      }, \"Autor: \"), \" \", author.username, ' '), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 8\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 8\n        }\n      }, ' ', /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 9\n        }\n      }, \"Descripci\\xF3n: \"), \" \", description, ' '), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 8\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 8\n        }\n      }, ' ', /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 9\n        }\n      }, \"Direcci\\xF3n: \"), \" \", location, ' '), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 8\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 8\n        }\n      }, ' ', /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 9\n        }\n      }, \"Plazas restantes: \"), \" \", attendance, ' '), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 8\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 8\n        }\n      }, ' ', /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 9\n        }\n      }, \"Asistentes: \"), ' ', !this.state.event && !this.state.event.assistance ? /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 10\n        }\n      }, \"No hay nadie apuntado, todav\\uFFFDa\") : this.state.event.assistance.map(user => user.username).join(', '), ' '), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 8\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 8\n        }\n      }, ' ', /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 9\n        }\n      }, \"Fecha: \"), \" \", moment(gameDate).format('DD/MM/YYYY h:mmA'), ' '), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 8\n        }\n      }), this.props.loggedInUser && /*#__PURE__*/React.createElement(Button, {\n        onClick: () => this.handleModal(true),\n        variant: \"success\",\n        block: true,\n        style: {\n          marginBottom: '20px'\n        },\n        className: \"btn-one\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 9\n        }\n      }, \"Dejar Rese\\xF1a\"), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 8\n        }\n      }, ' ', /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 9\n        }\n      }, \"Rese\\xF1as: \"), \" \", reviews, ' '))), /*#__PURE__*/React.createElement(Modal, {\n        show: this.state.modalShow,\n        onHide: () => this.handleModal(false),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 6\n        }\n      }, /*#__PURE__*/React.createElement(Modal.Body, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(ReviewForm, {\n        loggedInUser: this.props.loggedInUser,\n        eventId: this.state.event._id,\n        finishEventPost: this.finishEventPost,\n        closeModal: () => this.handleModal(false),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 8\n        }\n      }))), /*#__PURE__*/React.createElement(Toast, {\n        variant: \"success\",\n        onClose: () => this.handletoast(false),\n        show: this.state.toast.show,\n        delay: 4000,\n        autohide: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 6\n        }\n      }, /*#__PURE__*/React.createElement(Toast.Header, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        className: \"mr-auto\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 8\n        }\n      }, \"Mensaje\")), /*#__PURE__*/React.createElement(Toast.Body, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 7\n        }\n      }, this.state.toast.text)));\n    } else {\n      return /*#__PURE__*/React.createElement(Spinner, {\n        animation: \"border\",\n        role: \"status\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"sr-only\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 6\n        }\n      }, \"Loading...\"));\n    }\n  }\n\n}\n\nexport default EventDetails;","map":{"version":3,"sources":["/Users/alejandromurawczik/Movies/Programacion/ IronHack/Ironhack/week7/day5/BYOG/client/src/components/pages/eventDetails/EventDetails.js"],"names":["React","Component","EventService","moment","axios","Link","Container","Row","Col","Modal","Button","Spinner","Toast","ReviewForm","EventDetails","constructor","props","handleModal","visible","setState","modalShow","handleToast","text","toastCopy","state","toast","show","handleEventSign","e","attendance","event","assitance","includes","loggedInUser","username","eventCopy","assistance","push","_id","enevtCopy","assistanceCopy","attendanceCopy","eventService","editEvent","then","response","data","catch","err","console","log","componentDidMount","getEventInfo","finishEventPost","getAllEvents","id","match","params","eventId","getEvent","render","author","title","description","location","gameDate","reviews","isAttending","length","findIndex","user","span","offset","map","join","format","marginBottom","handletoast"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport EventService from '../../../service/events.service'\nimport moment from 'moment'\nimport axios from 'axios'\n\nimport { Link } from 'react-router-dom'\n\nimport Container from 'react-bootstrap/Container'\nimport Row from 'react-bootstrap/Row'\nimport Col from 'react-bootstrap/Col'\nimport Modal from 'react-bootstrap/Modal'\nimport Button from 'react-bootstrap/Button'\nimport Spinner from 'react-bootstrap/Spinner'\nimport Toast from 'react-bootstrap/Toast'\n// import GoogleMapReact from 'google-map-react'\n\nimport ReviewForm from './../reviewForm/ReviewForm'\nimport './EventDetails.css'\n\nclass EventDetails extends Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\tevent: null,\n\t\t\t// center: {\n\t\t\t// \tlat: props.lat,\n\t\t\t// \tlng: props.lng\n\t\t\t// },\n\t\t\tattendance: 0,\n\t\t\tloggedInUser: this.props.loggedInUser,\n\t\t\tmodalShow: false,\n\t\t\ttoast: {\n\t\t\t\tshow: false,\n\t\t\t\ttext: ''\n\t\t\t}\n\t\t}\n\t\tthis.eventService = new EventService()\n\t}\n\n\t// static defaultProps = {\n\t// \tcenter: {\n\t// \t\tlat: 40.420524,\n\t// \t\tlng: -3.705128\n\t// \t},\n\t// \tzoom: 16\n\t// }\n\n\thandleModal = visible => this.setState({ modalShow: visible })\n\thandleToast = (visible, text = '') => {\n\t\tconst toastCopy = { ...this.state.toast }\n\t\ttoastCopy.show = visible\n\t\ttoastCopy.text = text\n\t\tthis.setState({ toast: toastCopy })\n\t}\n\n\thandleEventSign = e => {\n\t\tif (attendance > 0 && !this.state.event.assitance.includes(this.props.loggedInUser.username)) {\n\t\tlet eventCopy = this.state.event\n\t\t\teventCopy.assistance.push(this.props.loggedInUser._id)\n\t\t\tenevtCopy.attendance -= 1\n\t\t}\n\t\tconst assistanceCopy = [...this.state.event.assistance, this.props.loggedInUser._id]\n\t\tlet attendanceCopy = this.state.event.attendance\n\t\n\t\n\t\tthis.eventService.editEvent(eventCopy)\n\t\t\t.then(response => this.setState({ event: response.data }))\n\t\t\t.catch(err => console.log(err))\n\n\t\t\t\n\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t// this.setState({ event: { ...this.state.event, assistance: assistanceCopy, attendance: attendanceCopy } }, () => console.log(\"vengo del callback \", this.state.event))\n\t\t\t\t\n\n\t\t\t\t// this.setState(\n\t\t\t\t// \t{ event: { ...this.state.event, assistance: assistanceCopy, attendance: attendanceCopy } }, () => {\n\t\t\t\t// \t\tthis.eventService\n\t\t\t\t// \t\t\t.editEvent(this.state.event)\n\t\t\t\t// \t\t\t.then(response => console.log(response.data))\n\t\t\t\t// \t\t\t// .then(response => this.setState({ event: response.data }))\n\t\t\t\t// \t\t\t.catch(err => console.log(err))\n\t\t\t\t// \t}\n\t\t\t\t// )\n\t\t\t\n\t\n\n\tgetEventInfo() {\n\t\tconst id = this.props.match.params.eventId\n\t\tthis.eventService\n\t\t\t.getEvent(id)\n\t\t\t.then(response => this.setState({ event: response.data }))\n\t\t\t.catch(err => console.log(err))\n\t}\n\t// () => this.getGoogleMap()\n\t// getGoogleMap() {\n\t// \tlet location = this.state.event.location\n\t// \tlet key = 'AIzaSyA5zll-K3WnkRdKTRaRgbyeC_JkL76ygyM'\n\t// \taxios.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${location}&key=${key}`).then(geores => {\n\t// \t\tlet latitude = geores.data.results[0].geometry.location.lat\n\t// \t\tlet longitude = geores.data.results[0].geometry.location.lng\n\t// \t\tthis.setState({\n\t// \t\t\tcenter: {\n\t// \t\t\t\tlat: latitude,\n\t// \t\t\t\tlng: longitude\n\t// \t\t\t}\n\t// \t\t})\n\t// \t})\n\t// }\n\n\tcomponentDidMount = () => {\n\t\tthis.getEventInfo()\n\t}\n\n\tfinishEventPost = () => {\n\t\tthis.getAllEvents()\n\t\tthis.handleModal(false)\n\t\tthis.handleToast(true, 'El comentario se ha creado con éxito!')\n\t}\n\n\trender() {\n\t\tif (this.state.event) {\n\t\t\tconst { author, title, description, location, attendance, gameDate, reviews, assistance } = this.state.event\n\n\t\t\tconst isAttending =\n\t\t\t\tthis.props.loggedInUser &&\n\t\t\t\tassistance &&\n\t\t\t\tassistance.length > 0 &&\n\t\t\t\tassistance.findIndex(user => user._id === this.props.loggedInUser._id) > -1\n\t\t\treturn (\n\t\t\t\t<Container as='section' className='event-details'>\n\t\t\t\t\t<h1>{title}</h1>\n\n\t\t\t\t\t<Row as='article'>\n\t\t\t\t\t\t<Col md={{ span: 5, offset: 1 }} className='map-button-event-details'>\n\t\t\t\t\t\t\t<div id='map'>\n\t\t\t\t\t\t\t\t{/* <GoogleMapReact\n\t\t\t\t\t\t\t\t\tbootstrapURLKeys={{ key: 'AIzaSyA5zll-K3WnkRdKTRaRgbyeC_JkL76ygyM' }}\n\t\t\t\t\t\t\t\t\tcenter={this.state.center}\n\t\t\t\t\t\t\t\t\tdefaultZoom={this.props.zoom}>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\tbackgroundImage: \"url('../../../../img/marker.png')\",\n\t\t\t\t\t\t\t\t\t\t\twidth: '26px',\n\t\t\t\t\t\t\t\t\t\t\theight: '29px'\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tlat={this.state.center.lat}\n\t\t\t\t\t\t\t\t\t\tlng={this.state.center.lng}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</GoogleMapReact> */}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className='event-details-buttons'>\n\t\t\t\t\t\t\t\t<Link to='/events' className='btn btn-success btn-one'>\n\t\t\t\t\t\t\t\t\tVolver\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t{this.state.loggedInUser && (\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\tonClick={this.handleEventSign}\n\t\t\t\t\t\t\t\t\t\tdisabled={isAttending}\n\t\t\t\t\t\t\t\t\t\tclassName='btn btn-success btn-one'>\n\t\t\t\t\t\t\t\t\t\tApuntarme\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col md={{ span: 5 }}>\n\t\t\t\t\t\t\t<h4>Detalles</h4>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t<strong>Autor: </strong> {author.username}{' '}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t<strong>Descripci&#243;n: </strong> {description}{' '}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t<strong>Direcci&#243;n: </strong> {location}{' '}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t<strong>Plazas restantes: </strong> {attendance}{' '}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t<strong>Asistentes: </strong>{' '}\n\t\t\t\t\t\t\t\t{!this.state.event && !this.state.event.assistance ? (\n\t\t\t\t\t\t\t\t\t<p>No hay nadie apuntado, todav�a</p>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\tthis.state.event.assistance.map(user => user.username).join(', ')\n\t\t\t\t\t\t\t\t)}{' '}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t<strong>Fecha: </strong> {moment(gameDate).format('DD/MM/YYYY h:mmA')}{' '}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t{this.props.loggedInUser && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tonClick={() => this.handleModal(true)}\n\t\t\t\t\t\t\t\t\tvariant='success'\n\t\t\t\t\t\t\t\t\tblock\n\t\t\t\t\t\t\t\t\tstyle={{ marginBottom: '20px' }}\n\t\t\t\t\t\t\t\t\tclassName='btn-one'>\n\t\t\t\t\t\t\t\t\tDejar Rese&ntilde;a\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t<strong>Rese&#241;as: </strong> {reviews}{' '}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t\t<Modal show={this.state.modalShow} onHide={() => this.handleModal(false)}>\n\t\t\t\t\t\t<Modal.Body>\n\t\t\t\t\t\t\t<ReviewForm\n\t\t\t\t\t\t\t\tloggedInUser={this.props.loggedInUser}\n\t\t\t\t\t\t\t\teventId={this.state.event._id}\n\t\t\t\t\t\t\t\tfinishEventPost={this.finishEventPost}\n\t\t\t\t\t\t\t\tcloseModal={() => this.handleModal(false)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Modal.Body>\n\t\t\t\t\t</Modal>\n\n\t\t\t\t\t<Toast\n\t\t\t\t\t\tvariant='success'\n\t\t\t\t\t\tonClose={() => this.handletoast(false)}\n\t\t\t\t\t\tshow={this.state.toast.show}\n\t\t\t\t\t\tdelay={4000}\n\t\t\t\t\t\tautohide>\n\t\t\t\t\t\t<Toast.Header>\n\t\t\t\t\t\t\t<strong className='mr-auto'>Mensaje</strong>\n\t\t\t\t\t\t</Toast.Header>\n\t\t\t\t\t\t<Toast.Body>{this.state.toast.text}</Toast.Body>\n\t\t\t\t\t</Toast>\n\t\t\t\t</Container>\n\t\t\t)\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<Spinner animation='border' role='status'>\n\t\t\t\t\t<span className='sr-only'>Loading...</span>\n\t\t\t\t</Spinner>\n\t\t\t)\n\t\t}\n\t}\n}\nexport default EventDetails\n"]},"metadata":{},"sourceType":"module"}