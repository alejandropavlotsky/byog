{"ast":null,"code":"var _jsxFileName = \"/Users/alejandromurawczik/Movies/Programacion/ IronHack/Ironhack/week7/day5/BYOG/client/src/components/pages/eventDetails/EventDetails.js\";\nimport React, { Component } from 'react';\nimport EventService from '../../../service/events.service';\nimport moment from 'moment';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Modal from 'react-bootstrap/Modal';\nimport Button from 'react-bootstrap/Button';\nimport Spinner from 'react-bootstrap/Spinner';\nimport Toast from 'react-bootstrap/Toast';\nimport GoogleMapReact from 'google-map-react';\nimport ReviewForm from './../reviewForm/ReviewForm';\nimport './EventDetails.css';\n\nclass EventDetails extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleModal = visible => this.setState({\n      modalShow: visible\n    });\n\n    this.handleToast = (visible, text = '') => {\n      const toastCopy = { ...this.state.toast\n      };\n      toastCopy.show = visible;\n      toastCopy.text = text;\n      this.setState({\n        toast: toastCopy\n      });\n    };\n\n    this.handleEventSign = e => {\n      const assistanceCopy = [...this.state.event.assistance];\n      assistanceCopy.push(this.props.loggedInUser._id);\n      this.eventService.editEvent({ ...this.state.event,\n        assistance: assistanceCopy\n      }).then(console.log);\n    };\n\n    this.componentDidMount = () => {\n      this.getEventInfo();\n    };\n\n    this.finishEventPost = () => {\n      this.getAllEvents();\n      this.handleModal(false);\n      this.handleToast(true, 'El comentario se ha creado con Ã©xito!');\n    };\n\n    this.state = {\n      event: null,\n      center: {\n        lat: props.lat,\n        lng: props.lng\n      },\n      loggedInUser: this.props.loggedInUser,\n      modalShow: false,\n      toast: {\n        show: false,\n        text: ''\n      }\n    };\n    this.eventService = new EventService();\n  }\n\n  getEventInfo() {\n    const id = this.props.match.params.eventId;\n    this.eventService.getEvent(id).then(response => this.setState({\n      event: response.data\n    }, () => this.getGoogleMap())).catch(err => console.log(err));\n  }\n\n  getGoogleMap() {\n    let location = this.state.event.location;\n    let key = \"AIzaSyA5zll-K3WnkRdKTRaRgbyeC_JkL76ygyM\";\n    axios.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${location}&key=${key}`).then(geores => {\n      let latitude = geores.data.results[0].geometry.location.lat;\n      let longitude = geores.data.results[0].geometry.location.lng;\n      this.setState({\n        center: {\n          lat: latitude,\n          lng: longitude\n        }\n      });\n    });\n  }\n\n  render() {\n    if (this.state.event) {\n      const isAttending = this.state.loggedInUser && this.state.event.assistance && this.state.event.assistance.length > 0 && this.state.event.assistance.findIndex(user => user._id === this.state.loggedInUser._id);\n      const {\n        author,\n        title,\n        description,\n        location,\n        attendance,\n        gameDate,\n        reviews\n      } = this.state.event;\n      return /*#__PURE__*/React.createElement(Container, {\n        as: \"section\",\n        className: \"event-details\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 21\n        }\n      }, title), /*#__PURE__*/React.createElement(Row, {\n        as: \"article\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        md: {\n          span: 5,\n          offset: 1\n        },\n        className: \"map-button-event-details\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        id: \"map\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(GoogleMapReact, {\n        bootstrapURLKeys: {\n          key: \"AIzaSyA5zll-K3WnkRdKTRaRgbyeC_JkL76ygyM\"\n        },\n        center: this.state.center,\n        defaultZoom: this.props.zoom,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          backgroundImage: \"url('../../../../img/marker.png')\",\n          width: \"26px\",\n          height: \"29px\"\n        },\n        lat: this.state.center.lat,\n        lng: this.state.center.lng,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 37\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"event-details-buttons\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(Link, {\n        to: \"/events\",\n        className: \"btn btn-success btn-one\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 33\n        }\n      }, \"Volver\"), this.state.loggedInUser && /*#__PURE__*/React.createElement(Button, {\n        onClick: this.handleEventSign,\n        disabled: isAttending === -1,\n        className: \"btn btn-success btn-one\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 37\n        }\n      }, \"Apuntarme\"))), /*#__PURE__*/React.createElement(Col, {\n        md: {\n          span: 5\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 29\n        }\n      }, \"Detalles\"), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 29\n        }\n      }, \" \", /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 33\n        }\n      }, \"Autor: \"), \" \", author.username, \" \"), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 29\n        }\n      }, \" \", /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 33\n        }\n      }, \"Descripci\\xF3n: \"), \" \", description, \" \"), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 29\n        }\n      }, \" \", /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 33\n        }\n      }, \"Direcci\\xF3n: \"), \" \", location, \" \"), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 29\n        }\n      }, \" \", /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 33\n        }\n      }, \"Participantes:  \"), \" \", attendance, \" \"), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 29\n        }\n      }, \" \", /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 33\n        }\n      }, \"Asistentes: \"), \" \", !this.state.event && !this.state.event.assistance ? \"No hay nadie apuntado, todavï¿½a\" : this.state.event.assistance.map(user => user.username).join(', '), \" \"), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 29\n        }\n      }, \" \", /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 33\n        }\n      }, \"Fecha: \"), \" \", moment(gameDate).format(\"DD/MM/YYYY h:mmA\"), \" \"), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 29\n        }\n      }), this.props.loggedInUser && /*#__PURE__*/React.createElement(Button, {\n        onClick: () => this.handleModal(true),\n        variant: \"success\",\n        block: true,\n        style: {\n          marginBottom: '20px'\n        },\n        className: \"btn-one\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 57\n        }\n      }, \"Dejar Rese\\xF1a\"), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 29\n        }\n      }, \" \", /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 33\n        }\n      }, \"Rese\\xF1as: \"), \" \", reviews, \" \"))), /*#__PURE__*/React.createElement(Modal, {\n        show: this.state.modalShow,\n        onHide: () => this.handleModal(false),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Modal.Body, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(ReviewForm, {\n        loggedInUser: this.props.loggedInUser,\n        eventId: this.state.event._id,\n        finishEventPost: this.finishEventPost,\n        closeModal: () => this.handleModal(false),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 29\n        }\n      }))), /*#__PURE__*/React.createElement(Toast, {\n        variant: \"success\",\n        onClose: () => this.handletoast(false),\n        show: this.state.toast.show,\n        delay: 4000,\n        autohide: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Toast.Header, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        className: \"mr-auto\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 39\n        }\n      }, \"Mensaje\")), /*#__PURE__*/React.createElement(Toast.Body, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 25\n        }\n      }, this.state.toast.text)));\n    } else {\n      return /*#__PURE__*/React.createElement(Spinner, {\n        animation: \"border\",\n        role: \"status\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"sr-only\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 25\n        }\n      }, \"Loading...\"));\n    }\n  }\n\n}\n\nEventDetails.defaultProps = {\n  center: {\n    lat: 40.420524,\n    lng: -3.705128\n  },\n  zoom: 16\n};\nexport default EventDetails;","map":{"version":3,"sources":["/Users/alejandromurawczik/Movies/Programacion/ IronHack/Ironhack/week7/day5/BYOG/client/src/components/pages/eventDetails/EventDetails.js"],"names":["React","Component","EventService","moment","axios","Link","Container","Row","Col","Modal","Button","Spinner","Toast","GoogleMapReact","ReviewForm","EventDetails","constructor","props","handleModal","visible","setState","modalShow","handleToast","text","toastCopy","state","toast","show","handleEventSign","e","assistanceCopy","event","assistance","push","loggedInUser","_id","eventService","editEvent","then","console","log","componentDidMount","getEventInfo","finishEventPost","getAllEvents","center","lat","lng","id","match","params","eventId","getEvent","response","data","getGoogleMap","catch","err","location","key","get","geores","latitude","results","geometry","longitude","render","isAttending","length","findIndex","user","author","title","description","attendance","gameDate","reviews","span","offset","zoom","backgroundImage","width","height","username","map","join","format","marginBottom","handletoast","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport EventService from '../../../service/events.service'\nimport moment from 'moment'\nimport axios from 'axios'\n\nimport { Link } from 'react-router-dom'\n\nimport Container from 'react-bootstrap/Container'\nimport Row from 'react-bootstrap/Row'\nimport Col from 'react-bootstrap/Col'\nimport Modal from 'react-bootstrap/Modal'\nimport Button from 'react-bootstrap/Button'\nimport Spinner from 'react-bootstrap/Spinner'\nimport Toast from 'react-bootstrap/Toast'\nimport GoogleMapReact from 'google-map-react'\n\nimport ReviewForm from './../reviewForm/ReviewForm'\nimport './EventDetails.css'\n\n\n\nclass EventDetails extends Component {\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            event: null,\n            center: {\n                lat: props.lat,\n                lng: props.lng\n            },\n            loggedInUser: this.props.loggedInUser,\n            modalShow: false,\n            toast: {\n                show: false,\n                text: ''\n            }\n        }\n        this.eventService = new EventService()\n    }\n\n    static defaultProps = {\n        center: {\n            lat: 40.420524,\n            lng: -3.705128\n        },\n        zoom: 16,\n    }\n\n    handleModal = visible => this.setState({ modalShow: visible })\n    handleToast = (visible, text = '') => {\n        const toastCopy = { ...this.state.toast }\n        toastCopy.show = visible\n        toastCopy.text = text\n        this.setState({toast: toastCopy})\n    }\n\n    handleEventSign = e => {\n        const assistanceCopy = [...this.state.event.assistance]\n        assistanceCopy.push(this.props.loggedInUser._id)\n            this.eventService.editEvent({ ...this.state.event, assistance: assistanceCopy })\n                .then(console.log)\n    }\n\n    getEventInfo() {\n        const id = this.props.match.params.eventId\n        this.eventService.getEvent(id)\n            .then(response => this.setState({ event: response.data }, () => this.getGoogleMap()))\n            .catch(err => console.log(err))\n    }\n\n    getGoogleMap() {\n        let location = this.state.event.location\n        let key = \"AIzaSyA5zll-K3WnkRdKTRaRgbyeC_JkL76ygyM\"\n        axios.get(\n            `https://maps.googleapis.com/maps/api/geocode/json?address=${location}&key=${key}`)\n            .then((geores) => {\n                let latitude = geores.data.results[0].geometry.location.lat\n                let longitude = geores.data.results[0].geometry.location.lng\n                this.setState({\n                    center: {\n                        lat: latitude,\n                        lng: longitude\n                    }\n                })\n            })\n    }\n\n    componentDidMount = () => { \n        this.getEventInfo()\n    }\n\n    finishEventPost = () => {\n        this.getAllEvents()\n        this.handleModal(false)\n        this.handleToast(true, 'El comentario se ha creado con Ã©xito!')\n    }\n\n    \n    render() {\n        \n        if (this.state.event) {\n            \n            const isAttending = this.state.loggedInUser && this.state.event.assistance && this.state.event.assistance.length > 0 && this.state.event.assistance.findIndex(user => user._id === this.state.loggedInUser._id)\n            \n            const { author, title, description, location, attendance,  gameDate, reviews } = this.state.event\n            return (\n                <Container as=\"section\" className=\"event-details\">\n                    <h1>{title}</h1>\n    \n                    <Row as=\"article\">\n                        <Col md={{ span: 5, offset: 1 }} className=\"map-button-event-details\">\n                            <div id=\"map\">\n                                <GoogleMapReact\n                                    bootstrapURLKeys={{ key: \"AIzaSyA5zll-K3WnkRdKTRaRgbyeC_JkL76ygyM\" }}\n                                    center={this.state.center}\n                                    defaultZoom={this.props.zoom}>\n                                    <div style={{ backgroundImage: \"url('../../../../img/marker.png')\", width: \"26px\", height: \"29px\" }}\n                                        lat={this.state.center.lat}\n                                        lng={this.state.center.lng}>\n                                    </div>\n                                </GoogleMapReact>\n                            </div>\n                            <div className=\"event-details-buttons\">\n                                <Link to=\"/events\" className=\"btn btn-success btn-one\">Volver</Link>\n                                {\n                                    this.state.loggedInUser &&\n                                    <Button onClick={this.handleEventSign} disabled={isAttending === -1} className=\"btn btn-success btn-one\">Apuntarme</Button>   \n                                }\n                            </div>\n                        </Col>\n                        <Col md={{ span: 5 }}>\n                            <h4>Detalles</h4>\n                            <hr />\n                            <p> <strong>Autor: </strong> {author.username} </p>\n                            <hr />\n                            <p> <strong>Descripci&#243;n: </strong> {description} </p>\n                            <hr />\n                            <p> <strong>Direcci&#243;n: </strong> {location} </p>\n                            <hr />\n                            <p> <strong>Participantes:  </strong> {attendance} </p>\n                            <hr />\n                            <p> <strong>Asistentes: </strong> {!this.state.event && !this.state.event.assistance ? \"No hay nadie apuntado, todavï¿½a\" : this.state.event.assistance.map(user => user.username).join(', ')} </p>\n                            <hr/>\n                            <p> <strong>Fecha: </strong> {moment(gameDate).format(\"DD/MM/YYYY h:mmA\")} </p>\n                            <hr />\n                            {this.props.loggedInUser && <Button onClick={() => this.handleModal(true)} variant=\"success\" block style={{ marginBottom: '20px' }} className=\"btn-one\">Dejar Rese&ntilde;a</Button>}\n                            <p> <strong>Rese&#241;as: </strong> {reviews} </p>\n                        </Col>\n                    </Row>\n                    <Modal show={this.state.modalShow} onHide={() => this.handleModal(false)}>\n                        <Modal.Body>\n                            <ReviewForm loggedInUser={this.props.loggedInUser} eventId={this.state.event._id} finishEventPost={this.finishEventPost} closeModal={() => this.handleModal(false)}/>\n                        </Modal.Body>\n                    </Modal>\n\n                    <Toast variant=\"success\" onClose={() => this.handletoast(false)} show={this.state.toast.show} delay={4000} autohide>\n                        <Toast.Header><strong className=\"mr-auto\">Mensaje</strong></Toast.Header>\n                        <Toast.Body>{this.state.toast.text}</Toast.Body>\n                </Toast>\n                </Container>\n            )\n        } else {\n            return  <Spinner animation=\"border\" role=\"status\">\n                        <span className=\"sr-only\">Loading...</span>\n                     </Spinner>\n            \n        }\n\n    }\n}\nexport default EventDetails"]},"metadata":{},"sourceType":"module"}