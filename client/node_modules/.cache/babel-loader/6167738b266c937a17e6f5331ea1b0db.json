{"ast":null,"code":"var _jsxFileName = \"/Users/alejandromurawczik/Movies/Programacion/ IronHack/Ironhack/week7/day5/BYOG/client/src/components/pages/eventDetails/EventDetails.js\";\nimport React, { Component } from 'react';\nimport EventService from '../../../service/events.service';\nimport moment from 'moment';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Modal from 'react-bootstrap/Modal';\nimport Button from 'react-bootstrap/Button';\nimport Spinner from 'react-bootstrap/Spinner';\nimport Toast from 'react-bootstrap/Toast';\nimport GoogleMapReact from 'google-map-react';\nimport ReviewForm from './../reviewForm/ReviewForm';\nimport './EventDetails.css';\n\nclass EventDetails extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleModal = visible => this.setState({\n      modalShow: visible\n    });\n\n    this.handleToast = (visible, text = '') => {\n      const toastCopy = { ...this.state.toast\n      };\n      toastCopy.show = visible;\n      toastCopy.text = text;\n      this.setState({\n        toast: toastCopy\n      });\n    };\n\n    this.handleEventSign = e => {\n      if (this.state.event.attendance > 0 && !this.state.event.assistance.includes(this.props.loggedInUser.username)) {\n        let eventCopy = this.state.event;\n        eventCopy.assistance.push(this.props.loggedInUser._id);\n        eventCopy.attendance -= 1;\n        this.eventService.editEvent(eventCopy).then(response => this.setState({\n          event: response.data\n        })).catch(err => console.log(err));\n      }\n    };\n\n    this.componentDidMount = () => {\n      this.getEventInfo();\n    };\n\n    this.finishEventPost = () => {\n      this.getAllEvents();\n      this.handleModal(false);\n      this.handleToast(true, 'El comentario se ha creado con éxito!');\n    };\n\n    this.state = {\n      event: null,\n      center: {\n        lat: props.lat,\n        lng: props.lng\n      },\n      attendance: 0,\n      loggedInUser: this.props.loggedInUser,\n      modalShow: false,\n      toast: {\n        show: false,\n        text: ''\n      }\n    };\n    this.eventService = new EventService();\n  }\n\n  getEventInfo() {\n    const id = this.props.match.params.eventId;\n    this.eventService.getEvent(id).then(response => this.setState({\n      event: response.data\n    }, () => this.getGoogleMap())).catch(err => console.log(err));\n  }\n\n  getGoogleMap() {\n    let location = this.state.event.location;\n    let key = 'AIzaSyA5zll-K3WnkRdKTRaRgbyeC_JkL76ygyM';\n    axios.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${location}&key=${key}`).then(geores => {\n      let latitude = geores.data.results[0].geometry.location.lat;\n      let longitude = geores.data.results[0].geometry.location.lng;\n      this.setState({\n        center: {\n          lat: latitude,\n          lng: longitude\n        }\n      });\n    });\n  }\n\n  render() {\n    if (this.state.event) {\n      const {\n        author,\n        title,\n        description,\n        location,\n        attendance,\n        gameDate,\n        reviews,\n        assistance\n      } = this.state.event;\n      const isAttending = this.props.loggedInUser && assistance && assistance.length > 0 && assistance.findIndex(user => user._id === this.props.loggedInUser._id) > -1;\n      return /*#__PURE__*/React.createElement(Container, {\n        as: \"section\",\n        className: \"event-details\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 6\n        }\n      }, title), /*#__PURE__*/React.createElement(Row, {\n        as: \"article\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 6\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        md: {\n          span: 5,\n          offset: 1\n        },\n        className: \"map-button-event-details\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        id: \"map\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 8\n        }\n      }, /*#__PURE__*/React.createElement(GoogleMapReact, {\n        bootstrapURLKeys: {\n          key: 'AIzaSyA5zll-K3WnkRdKTRaRgbyeC_JkL76ygyM'\n        },\n        center: this.state.center,\n        defaultZoom: this.props.zoom,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          backgroundImage: \"url('../../../../img/marker.png')\",\n          width: '26px',\n          height: '29px'\n        },\n        lat: this.state.center.lat,\n        lng: this.state.center.lng,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 10\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"event-details-buttons\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 8\n        }\n      }, /*#__PURE__*/React.createElement(Link, {\n        to: \"/events\",\n        className: \"btn btn-success btn-one\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 9\n        }\n      }, \"Volver\"), this.state.loggedInUser && /*#__PURE__*/React.createElement(Button, {\n        onClick: this.handleEventSign,\n        disabled: isAttending,\n        className: \"btn btn-success btn-one\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 10\n        }\n      }, \"Apuntarme\"))), /*#__PURE__*/React.createElement(Col, {\n        md: {\n          span: 5\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 8\n        }\n      }, \"Detalles\"), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 8\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 8\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 9\n        }\n      }, \"Autor: \"), \" \", author.username), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 8\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 8\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 9\n        }\n      }, \"Descripci\\xF3n: \"), \" \", description), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 8\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 8\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 9\n        }\n      }, \"Direcci\\xF3n: \"), \" \", location), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 8\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 8\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 9\n        }\n      }, \"Plazas restantes: \"), \" \", attendance), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 8\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 8\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 9\n        }\n      }, \"Asistentes: \"), !this.state.event && !this.state.event.assistance ? /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 10\n        }\n      }, \"No hay nadie apuntado, todav\\uFFFDa\") : this.state.event.assistance.map(user => this.state.user.username).join(', ')), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 8\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 8\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 9\n        }\n      }, \"Fecha: \"), \" \", moment(gameDate).format('DD/MM/YYYY h:mmA')), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 8\n        }\n      }), this.props.loggedInUser && /*#__PURE__*/React.createElement(Button, {\n        onClick: () => this.handleModal(true),\n        variant: \"success\",\n        block: true,\n        style: {\n          marginBottom: '20px'\n        },\n        className: \"btn-one\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 9\n        }\n      }, \"Dejar Rese\\xF1a\"), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 8\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 9\n        }\n      }, \"Rese\\xF1as: \"), \" \", reviews))), /*#__PURE__*/React.createElement(Modal, {\n        show: this.state.modalShow,\n        onHide: () => this.handleModal(false),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 6\n        }\n      }, /*#__PURE__*/React.createElement(Modal.Body, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(ReviewForm, {\n        loggedInUser: this.props.loggedInUser,\n        eventId: this.state.event._id,\n        finishEventPost: this.finishEventPost,\n        closeModal: () => this.handleModal(false),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 8\n        }\n      }))), /*#__PURE__*/React.createElement(Toast, {\n        variant: \"success\",\n        onClose: () => this.handletoast(false),\n        show: this.state.toast.show,\n        delay: 4000,\n        autohide: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 6\n        }\n      }, /*#__PURE__*/React.createElement(Toast.Header, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        className: \"mr-auto\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 8\n        }\n      }, \"Mensaje\")), /*#__PURE__*/React.createElement(Toast.Body, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 7\n        }\n      }, this.state.toast.text)));\n    } else {\n      return /*#__PURE__*/React.createElement(Spinner, {\n        animation: \"border\",\n        role: \"status\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"sr-only\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 6\n        }\n      }, \"Loading...\"));\n    }\n  }\n\n}\n\nEventDetails.defaultProps = {\n  center: {\n    lat: 40.420524,\n    lng: -3.705128\n  },\n  zoom: 16\n};\nexport default EventDetails;","map":{"version":3,"sources":["/Users/alejandromurawczik/Movies/Programacion/ IronHack/Ironhack/week7/day5/BYOG/client/src/components/pages/eventDetails/EventDetails.js"],"names":["React","Component","EventService","moment","axios","Link","Container","Row","Col","Modal","Button","Spinner","Toast","GoogleMapReact","ReviewForm","EventDetails","constructor","props","handleModal","visible","setState","modalShow","handleToast","text","toastCopy","state","toast","show","handleEventSign","e","event","attendance","assistance","includes","loggedInUser","username","eventCopy","push","_id","eventService","editEvent","then","response","data","catch","err","console","log","componentDidMount","getEventInfo","finishEventPost","getAllEvents","center","lat","lng","id","match","params","eventId","getEvent","getGoogleMap","location","key","get","geores","latitude","results","geometry","longitude","render","author","title","description","gameDate","reviews","isAttending","length","findIndex","user","span","offset","zoom","backgroundImage","width","height","map","join","format","marginBottom","handletoast","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport EventService from '../../../service/events.service'\nimport moment from 'moment'\nimport axios from 'axios'\n\nimport { Link } from 'react-router-dom'\n\nimport Container from 'react-bootstrap/Container'\nimport Row from 'react-bootstrap/Row'\nimport Col from 'react-bootstrap/Col'\nimport Modal from 'react-bootstrap/Modal'\nimport Button from 'react-bootstrap/Button'\nimport Spinner from 'react-bootstrap/Spinner'\nimport Toast from 'react-bootstrap/Toast'\nimport GoogleMapReact from 'google-map-react'\n\nimport ReviewForm from './../reviewForm/ReviewForm'\nimport './EventDetails.css'\n\nclass EventDetails extends Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\tevent: null,\n\t\t\tcenter: {\n\t\t\t\tlat: props.lat,\n\t\t\t\tlng: props.lng\n\t\t\t},\n\t\t\tattendance: 0,\n\t\t\tloggedInUser: this.props.loggedInUser,\n\t\t\tmodalShow: false,\n\t\t\ttoast: {\n\t\t\t\tshow: false,\n\t\t\t\ttext: ''\n\t\t\t}\n\t\t}\n\t\tthis.eventService = new EventService()\n\t}\n\n\tstatic defaultProps = {\n\t\tcenter: {\n\t\t\tlat: 40.420524,\n\t\t\tlng: -3.705128\n\t\t},\n\t\tzoom: 16\n\t}\n\n\thandleModal = visible => this.setState({ modalShow: visible })\n\thandleToast = (visible, text = '') => {\n\t\tconst toastCopy = { ...this.state.toast }\n\t\ttoastCopy.show = visible\n\t\ttoastCopy.text = text\n\t\tthis.setState({ toast: toastCopy })\n\t}\n\n\thandleEventSign = e => {\n\t\tif (this.state.event.attendance > 0 && !this.state.event.assistance.includes(this.props.loggedInUser.username)) {\n\t\t\tlet eventCopy = this.state.event\n\t\t\teventCopy.assistance.push(this.props.loggedInUser._id)\n\t\t\teventCopy.attendance -= 1\n\t\t\tthis.eventService\n\t\t\t\t.editEvent(eventCopy)\n\t\t\t\t.then(response => this.setState({ event: response.data }))\n\t\t\t\t.catch(err => console.log(err))\n\t\t}\n\t}\n\n\tgetEventInfo() {\n\t\tconst id = this.props.match.params.eventId\n\t\tthis.eventService\n\t\t\t.getEvent(id)\n\t\t\t.then(response => this.setState({ event: response.data }, () => this.getGoogleMap()))\n\t\t\t.catch(err => console.log(err))\n\t}\n\n\tgetGoogleMap() {\n\t\tlet location = this.state.event.location\n\t\tlet key = 'AIzaSyA5zll-K3WnkRdKTRaRgbyeC_JkL76ygyM'\n\t\taxios.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${location}&key=${key}`).then(geores => {\n\t\t\tlet latitude = geores.data.results[0].geometry.location.lat\n\t\t\tlet longitude = geores.data.results[0].geometry.location.lng\n\t\t\tthis.setState({\n\t\t\t\tcenter: {\n\t\t\t\t\tlat: latitude,\n\t\t\t\t\tlng: longitude\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\tcomponentDidMount = () => {\n\t\tthis.getEventInfo()\n\t}\n\n\tfinishEventPost = () => {\n\t\tthis.getAllEvents()\n\t\tthis.handleModal(false)\n\t\tthis.handleToast(true, 'El comentario se ha creado con éxito!')\n\t}\n\n\trender() {\n\t\tif (this.state.event) {\n\t\t\tconst { author, title, description, location, attendance, gameDate, reviews, assistance } = this.state.event\n\n\t\t\tconst isAttending =\n\t\t\t\tthis.props.loggedInUser &&\n\t\t\t\tassistance &&\n\t\t\t\tassistance.length > 0 &&\n\t\t\t\tassistance.findIndex(user => user._id === this.props.loggedInUser._id) > -1\n\t\t\treturn (\n\t\t\t\t<Container as='section' className='event-details'>\n\t\t\t\t\t<h1>{title}</h1>\n\n\t\t\t\t\t<Row as='article'>\n\t\t\t\t\t\t<Col md={{ span: 5, offset: 1 }} className='map-button-event-details'>\n\t\t\t\t\t\t\t<div id='map'>\n\t\t\t\t\t\t\t\t<GoogleMapReact\n\t\t\t\t\t\t\t\t\tbootstrapURLKeys={{ key: 'AIzaSyA5zll-K3WnkRdKTRaRgbyeC_JkL76ygyM' }}\n\t\t\t\t\t\t\t\t\tcenter={this.state.center}\n\t\t\t\t\t\t\t\t\tdefaultZoom={this.props.zoom}>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\tbackgroundImage: \"url('../../../../img/marker.png')\",\n\t\t\t\t\t\t\t\t\t\t\twidth: '26px',\n\t\t\t\t\t\t\t\t\t\t\theight: '29px'\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tlat={this.state.center.lat}\n\t\t\t\t\t\t\t\t\t\tlng={this.state.center.lng}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</GoogleMapReact>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className='event-details-buttons'>\n\t\t\t\t\t\t\t\t<Link to='/events' className='btn btn-success btn-one'>\n\t\t\t\t\t\t\t\t\tVolver\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t{this.state.loggedInUser && (\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\tonClick={this.handleEventSign}\n\t\t\t\t\t\t\t\t\t\tdisabled={isAttending}\n\t\t\t\t\t\t\t\t\t\tclassName='btn btn-success btn-one'>\n\t\t\t\t\t\t\t\t\t\tApuntarme\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col md={{ span: 5 }}>\n\t\t\t\t\t\t\t<h4>Detalles</h4>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<strong>Autor: </strong> {author.username}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<strong>Descripci&#243;n: </strong> {description}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t<p>\n\n\t\t\t\t\t\t\t\t<strong>Direcci&#243;n: </strong> {location}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<strong>Plazas restantes: </strong> {attendance}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<strong>Asistentes: </strong>\n\t\t\t\t\t\t\t\t{!this.state.event && !this.state.event.assistance ? (\n\t\t\t\t\t\t\t\t\t<p>No hay nadie apuntado, todav�a</p>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\tthis.state.event.assistance.map(user => this.state.user.username).join(', ')\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<strong>Fecha: </strong> {moment(gameDate).format('DD/MM/YYYY h:mmA')}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t{this.props.loggedInUser && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tonClick={() => this.handleModal(true)}\n\t\t\t\t\t\t\t\t\tvariant='success'\n\t\t\t\t\t\t\t\t\tblock\n\t\t\t\t\t\t\t\t\tstyle={{ marginBottom: '20px' }}\n\t\t\t\t\t\t\t\t\tclassName='btn-one'>\n\t\t\t\t\t\t\t\t\tDejar Rese&ntilde;a\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<strong>Rese&#241;as: </strong> {reviews}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t\t<Modal show={this.state.modalShow} onHide={() => this.handleModal(false)}>\n\t\t\t\t\t\t<Modal.Body>\n\t\t\t\t\t\t\t<ReviewForm\n\t\t\t\t\t\t\t\tloggedInUser={this.props.loggedInUser}\n\t\t\t\t\t\t\t\teventId={this.state.event._id}\n\t\t\t\t\t\t\t\tfinishEventPost={this.finishEventPost}\n\t\t\t\t\t\t\t\tcloseModal={() => this.handleModal(false)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Modal.Body>\n\t\t\t\t\t</Modal>\n\n\t\t\t\t\t<Toast\n\t\t\t\t\t\tvariant='success'\n\t\t\t\t\t\tonClose={() => this.handletoast(false)}\n\t\t\t\t\t\tshow={this.state.toast.show}\n\t\t\t\t\t\tdelay={4000}\n\t\t\t\t\t\tautohide>\n\t\t\t\t\t\t<Toast.Header>\n\t\t\t\t\t\t\t<strong className='mr-auto'>Mensaje</strong>\n\t\t\t\t\t\t</Toast.Header>\n\t\t\t\t\t\t<Toast.Body>{this.state.toast.text}</Toast.Body>\n\t\t\t\t\t</Toast>\n\t\t\t\t</Container>\n\t\t\t)\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<Spinner animation='border' role='status'>\n\t\t\t\t\t<span className='sr-only'>Loading...</span>\n\t\t\t\t</Spinner>\n\t\t\t)\n\t\t}\n\t}\n}\nexport default EventDetails\n"]},"metadata":{},"sourceType":"module"}